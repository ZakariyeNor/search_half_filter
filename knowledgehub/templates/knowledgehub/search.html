{% extends "base.html" %}
{% load widget_tweaks %}
{% block content %}
<div class="container py-5">

 <!-- <form method="get" class="mb-4">
    <input type="hidden" name="q" value="{{ query }}">

    <div class="row g-3 align-items-end"> -->
      <!-- Categories -->
      <!-- <div class="col-md-3">
        <label class="form-label">Category</label>
        {{ article_filter.form.categories }}
      </div> -->

      <!-- Tags -->
     <!--  <div class="col-md-3">
        <label class="form-label">Tag</label>
        {{ article_filter.form.tags }}
      </div> -->

      <!-- Date From -->
      <!-- <div class="col-md-2">
        <label class="form-label">From</label>
        {{ article_filter.form.created_at__gte }}
      </div> -->

      <!-- Date To -->
      <!-- <div class="col-md-2">
        <label class="form-label">To</label>
        {{ article_filter.form.created_at__lte }}
      </div> -->

      <!-- Submit -->
      <!-- <div class="col-md-2">
        <button type="submit" class="btn btn-primary w-100">Apply Filters</button>
      </div>
    </div>
  </form> -->


<!-- <hr>

<h2>Articles</h2>
<ul>
    {% for article in filter.qs %}
        <li>
            <a href="{% url 'knowledgehub:article_detail' article.pk %}">{{ article.title }}</a>
            - {{ article.created_at }}
        </li>
    {% empty %}
        <li>No articles found.</li>
    {% endfor %}
</ul> -->


  <h1 class="mb-4">Search Results</h1>

<!-- Search Form -->
<form method="get" action="{% url 'knowledgehub:search' %}">
  <input type="text" name="q" class="form-control"
         placeholder="Search Articles..."
         data-autocomplete-light-url="{% url 'knowledgehub:article-autocomplete' %}">
  <button type="submit" class="btn btn-primary mt-2">Search</button>
</form>


{% if query %}
  <p class="mb-4">Showing results for: <strong>{{ query }}</strong></p>

  <!-- Articles -->
  <section class="mb-5">
    <h2>Articles</h2>
    <div class="row">
      {% for article in results_articles %}
      <div class="col-md-4 mb-4">
        <div class="card h-100">
          <div class="card-body">
            <h5 class="card-title">{{ article.title|safe }}</h5>
            <p class="card-text">{{ article.highlighted_content|default:article.content|safe }}</p>
            <a href="{% url 'knowledgehub:article_detail' article.id %}" class="btn btn-sm btn-outline-primary">Read More</a>
          </div>
        </div>
      </div>
      {% empty %}
      <p>No articles found.</p>
      {% endfor %}
    </div>
  </section>

  <!-- Books -->
  <section class="mb-5">
    <h2>Books</h2>
    <div class="row">
      {% for book in results_books %}
      <div class="col-md-4 mb-4">
        <div class="card h-100">
          <div class="card-body">
            <h5 class="card-title">{{ book.title|safe }}</h5>
            <p class="card-text">by {{ book.author }}</p>
            <p class="card-text">{{ book.highlighted_description|default:book.description|safe }}</p>
            <a href="{% url 'knowledgehub:book_detail' book.id %}" class="btn btn-sm btn-outline-primary">View Book</a>
          </div>
        </div>
      </div>
      {% empty %}
      <p>No books found.</p>
      {% endfor %}
    </div>
  </section>

  <!-- Videos -->
  <section class="mb-5">
    <h2>Videos</h2>
    <div class="row">
      {% for video in results_videos %}
      <div class="col-md-4 mb-4">
        <div class="card h-100">
          <div class="card-body">
            <h5 class="card-title">{{ video.title|safe }}</h5>
            <p class="card-text">{{ video.highlighted_description|default:video.description|safe }}</p>
            <a href="{{ video.url }}" class="btn btn-sm btn-outline-primary" target="_blank">Watch Video</a>
          </div>
        </div>
      </div>
      {% empty %}
      <p>No videos found.</p>
      {% endfor %}
    </div>
  </section>

  <!-- Case Studies -->
  <section class="mb-5">
    <h2>Case Studies</h2>
    <div class="row">
      {% for case in results_case_studies %}
      <div class="col-md-4 mb-4">
        <div class="card h-100">
          <div class="card-body">
            <h5 class="card-title">{{ case.title|safe }}</h5>
            <p class="card-text">{{ case.highlighted_abstract|default:case.abstract|safe }}</p>
            <a href="{% url 'knowledgehub:case_study_detail' case.id %}" class="btn btn-sm btn-outline-primary">Read More</a>
          </div>
        </div>
      </div>
      {% empty %}
      <p>No case studies found.</p>
      {% endfor %}
    </div>
  </section>

{% else %}
  <p>Enter a search term to see results.</p>
{% endif %}
{% endblock %}
